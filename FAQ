Frequently Asked Questions (FAQ)
================================

(Version: 2005-12-20)

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
! This file is deprecated. Please refer to the "Frequently Asked Questions" !
! section of the handbook for the latest version of the FAQ.                !
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!


Reporting bugs
--------------

Q:  I think, I found a bug. Where can I report it?

A:  There are two possible ways, how to do it. You can either click on the
    menu item Help->Report Bug... and submit your report there, or you go to
    the project's bug tracking site:
    http://developer.berlios.de/bugs/?group_id=769.

    NOTE:
    - Before reporting a bug, try the latest version of Smb4K. Maybe the bug
      you found has already been fixed.
    - If you are reporting a bug, please include as much information as
      possible. To reproduce your problem, it is mandatory that you tell us
      what you did exactly. Also, it is necessary that you provide the version
      of Smb4K and KDE that you are using and which operating system (Linux,
      FreeBSD, etc.) and distribution (if applicable) is running on your
      computer.


Compilation and Installation
----------------------------

Q:  I have compiled Smb4K from source. After starting it, I can't see the
    toolbar. What went wrong?

A:  Most likely, you installed Smb4K to the wrong place. To correct this,
    uninstall Smb4K first. Go to the source's root directory and run

    $ su -c "make uninstall"

    from the shell.

    NOTE:
      This will not work, if you ran

      $ make distclean

      in the meantime.

    Now, reconfigure the source by passing the '--prefix=PREFIX' option to
    the configure script:

    $ ./configure --prefix=`kde-config --prefix`

    Afterwards, compile and install it:

    $ make && su -c "make install"

    Smb4K will be installed to the right path and everything should work fine.


Q:  I want to compile Smb4K from source and I want to be able to uninstall it
    easily. Is that possible?

A:  If you want to be able to uninstall Smb4K easily, you might want to use
    checkinstall. It keeps track of all files installed by the "make install"
    command or equivalent, creates a Slackware, RPM, or Debian package with
    those files, and adds it to the installed packages database, allowing for
    easy package removal or distribution.

    Configuration, compilation and installation using checkinstall will work
    like this (see also above):

    $ ./configure --prefix=`kde-config --prefix` && make && su -c "checkinstall"


Q:  The configure script fails and tells me, it can't find my Qt
    installation.

A:  There are two things you should check:
    1. It may be that the Qt header files are not installed. If this is true,
       install them and run the configure script again.
    2. The QTDIR environment variable might not be set properly or at all.
       Check for the following line in your ~/.bashrc file

       export QTDIR=PREFIX

       and add it, if it is not present. Replace PREFIX with the prefix of your
       Qt installation. Run

       $ source ~/.bashrc

       from the shell. Now, you're set for a second configuration attempt.

     If the header files are installed and the QTDIR variable is set, but you
     still get the same error, you might want to try to pass the
     '--with-qt-includes=/path/to/header/files' option to the configure script.


Q:  The configure script fails and tells me, it can't find my KDE
    installation.

A:  There are two things you should check:
    1. Probably the KDE header files are not installed. If so, install them and
       run the configure script again.
    2. The KDEDIR environment variable might not be set properly or at all.
       Check for the following line in your ~/.bashrc file

       export KDEDIR=PREFIX

       and add it, if it is not present. Replace PREFIX with the prefix of your
       KDE installation. Run

       $ source ~/.bashrc

       from the shell. Now, you're set for a new configuration attempt.


Browsing
--------

Q:  When I scan the network, there are several workgroups appearing, that
    are not accessible. What can I do to avoid this behavior?

A:  This behavior might be caused by Samba's enhancements to cross-subnet browse
    propagation (see smb.conf(5) manual page). You can switch off this feature in
    the smb.conf by adding the following entry to the [global] section:

    [global]
    ...
    enhanced browsing = no
    ...

    This option seems to have no effect, if you do not use a WINS server.


Q:  When I start Smb4K, there is nothing in the network browser!

A:  Please follow this list to fix the problem:
    - If your network has a WINS server, add it to the [global] section of
      your smb.conf file and restart Samba (if necessary) and Smb4K.
    - Make sure the SMB ports 137 (TCP+UDP), 138 (UDP), 139 (TCP+UDP), and 445
      (TCP+UDP) are not blocked by a firewall. If you are using SUSE's firewall,
      see below.
    - Try to use a different look-up method. Therefore, change the settings
      under Settings->Configure Smb4K...->Network->Browse List.

   If there still isn't anything visible in the browser widget, ask for help on
   the Smb4K-general mailing list or file a bug report.


Q:  I'm using SUSE Linux with its firewall enabled. As normal user, I cannot
    browse the network neighborhood. The browser window is always empty.

A:  The solution to this issue is covered by several pages on the net. You may
    want to take a look at:
    - Novell Cool Solutions:
      http://www.novell.com/coolsolutions/feature/11952.html
    - HOWTO at TweakHound:
      http://www.tweakhound.com/linux/samba/page_8.htm
    - SUSE Linux Forums:
      http://forums.suselinuxsupport.de/


Q:  If I open a Windows 98 server, there are no shares shown although I know
    that there should be serveral. What's wrong?

A:  As of version 0.6.0, Smb4K uses the 'net' command to retrieve the list of
    shares from a host. With the default settings, the 'net' command will try
    to guess the protocol that is needed to communicate with the server (RAP or
    RPC). Unfortunately, this does not seems to work well with Windows 98 and
    earlier. To make things work, go to Settings->Configure Smb4K...->Samba->
    net->Protocol and check the RAP button.

    NOTE:
    This does not apply to versions prior to 0.6.0, because they use the RAP
    protocol based 'smbclient' command to retrieve the browse list. Smb4K
    0.7.0 and above will automatically rescan the target server with the RAP
    protocol if the first attempt failed.


Mounting/Unmounting of shares
-----------------------------

Q:  Mounting a share fails and I get the following error message:

    smbmnt must be installed suid root for direct user mounts (500,500)
    smbmnt failed: 1

    What does that mean?

A:  It means, that you do not have enough permissions to mount SMB shares.
    There are two things you can do:
    1. Set the SUID root bit for smbmnt. Therefore you have to find out,
       where the binary is located. Try

       $ ls -la `which smbmnt`

       in the shell. If this is a symlink, follow it to find the binary.
       Change into the directory, where smbmnt resides and run

       $ chmod +s smbmnt

       Now the mounting should work.

       WARNING:
       Do not set the SUID root bit for smbmount! If you do, mounting will
       too fail with the following error message:

       libsmb based programs must *NOT* be setuid root.
       6002: Connection to dustpuppy failed
       SMB connection failed

    2. You can execute mount and umount SUID using the program super (since
       Smb4K 0.4.0) or sudo (since Smb4K 0.5.0). To enable this feature, you
       have to go to Settings->Configure Smb4K...->Super User and adjust the
       settings.


Q:  If I want to unmount a share, I get the following message:

    smbumount must be installed suid root

    What do I have to do?

A:  You have similar options as above. Either you set the SUID root bit for
    smbumount or you enable the feature "Use super user privileges to mount and
    unmount shares" under Settings->Configure Smb4K...->Super User->Actions.
    For details see above.


Q:  I'm using the CIFS file system for mounting and I've set the UID/GID in
    the configuration dialog, but Smb4K does not seem to care about that at
    all!

A:  This is a Samba feature. If the target server supports the CIFS Unix
    extentions, the uid and gid option will be ignored. For more information
    see the mount.cifs(8) manual page.


Q:  When I try to mount a share from a Windows 2003 server, I get the following
    error message

    cli_negprot: SMB signing is mandatory and we have disabled it.
    4377: protocol negotiation failed
    SMB connection failed

    and the mounting fails. What's wrong?

A:  You are using the SMBFS file system that does not support signing. You
    have to switch to the CIFS file system in order to be able to mount the
    share. Go to Settings->Configure Smb4K...->Samba->File System and choose
    CIFS instead of SMBFS.

    NOTE:
    Smb4K will use the mount.cifs binary to mount CIFS shares. That's why
    you should also enable the "Use super user privileges to mount and unmount
    shares" option under Settings->Configure Smb4K...->Super User->Actions.


Q:  Smb4K fails unmounting a share. The error message is:

    Could not unmount /mount/point: Device or resource busy

    How can I make unmounting work?

A:  First of all, check that you haven't opened the mount point or one of its
    subdirectories in a shell or with a file manager. Also, make sure you
    haven't opened any file belonging to the share. If neither is the case,
    you might have encountered a problem, that is known but not related to
    Smb4K. It seems, that under certain circumstances (that we could not
    figure out exactly) kdeinit (KDE < 3.4) background processes access files
    and/or directories of the share and keep them open. Unmounting is not
    possible unless you send

    $ kill -HUP <PID>

    to each kdeinit instance that has access to the share or its files.

    Alternatively, you can force the unmounting of the share. Highlight the
    share and use the Shares->Force Unmounting menu item or press Ctrl+F.


Q:  I'm using sudo and the CIFS file system. Everytime I want to mount a share
    (from a Windows 2003 server), I get the following error:

    mount error 13 = Permission denied
    Refer to the mount.cifs(8) manual page (e.g.man mount.cifs)

    What can I do to make mounting work?

A:  It is very possible, that the 'env_reset' flag has been set in the
    /etc/sudoers file (It's the default in Gentoo for example.), which
    resets the environment to only contain a limited number of environment
    variables. Especially, the PASSWD variable is removed which is needed by
    Smb4K.

    To make mounting work, there are three things you should try alternatively:
    - Insert manually the following line after the line beginning with
      "User_Alias SMB4KUSERS":
      Defaults:SMB4KUSERS env_keep=PASSWD
      This should be the preferred method on a multi-user system.
    - Remove the Smb4K user entries from /etc/sudoers manually or using
      Smb4K and rewrite them (Smb4K >= 0.6.4).
    - Comment out the 'env_reset' variable (not recommended).

    If you are still not able to mount a share, please file a bug report.


Miscellaneous
-------------

Q:  I'm using Smb4K 0.4.x. After starting it, I cannot see the main window.
    Is this a bug?

A:  No. This is a special behavior of the 0.4.x series, which was changed in
    later releases. Smb4K 0.4.x immediately docks to the system tray. You'll
    find an icon there with which you can bring up the main window. Restoring
    the visible main window after logging in will not work.


Q:  I want to use super to mount and unmount the shares. When I try to enable
    either "Use super user privileges to force the unmounting of (broken)
    shares" or "Use super user privileges to mount and unmount shares", Smb4K
    complains that it cannot find the super.tab file. What do I have to do?

A:  Create the super.tab file in the appropriate etc directory. Therefore
    change into it (most likely /etc (Linux) or /usr/local/etc (FreeBSD)) and
    run

    $ touch super.tab && chmod 0644 super.tab

    as root. Smb4K will take care of the rest.


Q:  After installing Smb4K, I wanted to take advantage of the Konqueror
    plugin but I couldn't find it. What do I have to do?

A:  Right-click on the frame of Konqueror's navigation widget and choose
    Add New->Samba Browser from the menu. The Konqueror plugin will be
    added.
